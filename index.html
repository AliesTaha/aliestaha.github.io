<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ali taha - Desktop OS</title>
    <link rel="icon" type="image/png" href="AT.png">
    <link rel="stylesheet" href="desktop-os.css">
</head>
<body>
    <!-- Menu Bar (macOS-style) -->
    <div class="menu-bar">
        <div class="menu-left">
            <div class="menu-item logo">üçé ali taha</div>
            <div class="menu-item">File</div>
            <div class="menu-item">Edit</div>
            <div class="menu-item">View</div>
            <div class="menu-item">Window</div>
        </div>
        <div class="menu-right">
            <div class="menu-time" id="clock">12:00 PM</div>
        </div>
    </div>

    <!-- Windows Container -->
    <div id="windows-container"></div>

    <!-- Snap Preview Overlay -->
    <div id="snap-preview" class="snap-preview"></div>

    <!-- Desktop Area -->
    <div class="desktop">
        <!-- Desktop Icons -->
        <div class="desktop-icons">
            <!-- Row 1 -->
            <div class="desktop-icon" data-window="home" data-url="index.html">
                <div class="icon-image">üìÑ</div>
                <div class="icon-label">home.mdx</div>
            </div>

            <div class="desktop-icon" data-window="technical" data-url="technical.html">
                <div class="icon-image">üíª</div>
                <div class="icon-label">technical.mdx</div>
            </div>

            <div class="desktop-icon" data-window="philosophy" data-url="philosophy.html">
                <div class="icon-image">üß†</div>
                <div class="icon-label">philosophy.mdx</div>
            </div>

            <!-- Row 2 -->
            <div class="desktop-icon" data-window="experience" data-url="experience.html">
                <div class="icon-image">üíº</div>
                <div class="icon-label">experience.mdx</div>
            </div>

            <div class="desktop-icon" data-window="contact" data-url="contact.html">
                <div class="icon-image">‚úâÔ∏è</div>
                <div class="icon-label">contact.mdx</div>
            </div>

            <!-- Row 3 -->
            <div class="desktop-icon" data-window="readme" data-special="readme">
                <div class="icon-image">üìã</div>
                <div class="icon-label">README.md</div>
            </div>
        </div>

        <!-- Central Feature Area -->
        <div class="central-feature">
            <div class="feature-card">
                <img src="me_sf.png" alt="ali taha" class="profile-image">
                <p class="greeting">hey, i'm ali</p>
            </div>
        </div>

        <!-- Special Desktop Elements -->
        <div class="desktop-shortcuts">
            <div class="desktop-icon special-icon roadmap-icon">
                <div class="icon-image">üó∫Ô∏è</div>
                <div class="icon-label">Roadmap</div>
            </div>

            <div class="desktop-icon special-icon trash-icon">
                <div class="icon-image">üóëÔ∏è</div>
                <div class="icon-label">Trash</div>
            </div>
        </div>
    </div>

    <!-- Dock (bottom) -->
    <div class="dock">
        <div class="dock-item" title="home.mdx" data-window="home">
            <div class="dock-icon">üìÑ</div>
        </div>
        <div class="dock-item" title="technical.mdx" data-window="technical">
            <div class="dock-icon">üíª</div>
        </div>
        <div class="dock-item" title="philosophy.mdx" data-window="philosophy">
            <div class="dock-icon">üß†</div>
        </div>
        <div class="dock-item" title="experience.mdx" data-window="experience">
            <div class="dock-icon">üíº</div>
        </div>
        <div class="dock-item" title="contact.mdx" data-window="contact">
            <div class="dock-icon">‚úâÔ∏è</div>
        </div>
        <div class="dock-separator"></div>
        <div class="dock-item trash-dock-icon" title="Trash">
            <div class="dock-icon">üóëÔ∏è</div>
        </div>
    </div>

    <script>
        // Window Management System
        class WindowManager {
            constructor() {
                this.windows = new Map();
                this.windowStates = new Map(); // Store window states (position, size, etc)
                this.zIndexCounter = 1000;
                this.container = document.getElementById('windows-container');
                this.dragState = {
                    isDragging: false,
                    currentWindow: null,
                    currentWindowId: null,
                    startX: 0,
                    startY: 0,
                    windowX: 0,
                    windowY: 0
                };
                this.snapPreview = document.getElementById('snap-preview');
                this.snapZone = null; // 'left', 'right', 'top', or null
                this.iconDragState = {
                    isDragging: false,
                    currentIcon: null,
                    startX: 0,
                    startY: 0,
                    iconX: 0,
                    iconY: 0
                };
                this.resizeState = {
                    isResizing: false,
                    currentWindow: null,
                    direction: null,
                    startX: 0,
                    startY: 0,
                    startWidth: 0,
                    startHeight: 0,
                    startLeft: 0,
                    startTop: 0
                };
            }

            createWindow(id, title, content, url = null) {
                // Check if window already exists
                if (this.windows.has(id)) {
                    this.focusWindow(id);
                    return;
                }

                // Create window element
                const windowEl = document.createElement('div');
                windowEl.className = 'window active';
                windowEl.dataset.windowId = id;
                windowEl.style.zIndex = ++this.zIndexCounter;
                
                // Random position (slightly offset from center)
                const offsetX = Math.random() * 100 - 50;
                const offsetY = Math.random() * 60 - 30;
                windowEl.style.left = `calc(50% - 300px + ${offsetX}px)`;
                windowEl.style.top = `calc(50% - 200px + ${offsetY}px)`;
                windowEl.style.width = '600px';
                windowEl.style.height = '500px';

                // Create window structure
                windowEl.innerHTML = `
                    <div class="window-title-bar">
                        <div class="window-controls">
                            <button class="window-button close" title="Close"></button>
                            <button class="window-button minimize" title="Minimize"></button>
                            <button class="window-button maximize" title="Maximize"></button>
                        </div>
                        <div class="window-title">${title}</div>
                        <div style="width: 68px;"></div>
                    </div>
                    <div class="window-content">
                        <div class="window-loading">
                            <div class="spinner"></div>
                            <div>Loading...</div>
                        </div>
                    </div>
                    <div class="resize-handle resize-n"></div>
                    <div class="resize-handle resize-e"></div>
                    <div class="resize-handle resize-s"></div>
                    <div class="resize-handle resize-w"></div>
                    <div class="resize-handle resize-ne"></div>
                    <div class="resize-handle resize-se"></div>
                    <div class="resize-handle resize-sw"></div>
                    <div class="resize-handle resize-nw"></div>
                `;

                // Add to container
                this.container.appendChild(windowEl);
                this.windows.set(id, windowEl);
                
                // Store initial state
                this.windowStates.set(id, {
                    state: 'normal', // normal, minimized, maximized
                    normalPosition: { left: offsetX, top: offsetY, width: 600, height: 500 }
                });

                // Setup event listeners
                this.setupWindowEvents(windowEl, id);

                // Load content
                if (url) {
                    this.loadContent(windowEl, url);
                } else if (content) {
                    windowEl.querySelector('.window-content').innerHTML = content;
                }
            }

            setupWindowEvents(windowEl, id) {
                // Close button
                windowEl.querySelector('.window-button.close').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.closeWindow(id);
                });

                // Minimize button
                windowEl.querySelector('.window-button.minimize').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.minimizeWindow(id);
                });

                // Maximize button
                windowEl.querySelector('.window-button.maximize').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.toggleMaximize(id);
                });

                // Focus on click
                windowEl.addEventListener('mousedown', (e) => {
                    this.focusWindow(id);
                });

                // Make window title bar draggable
                const titleBar = windowEl.querySelector('.window-title-bar');
                titleBar.addEventListener('mousedown', (e) => {
                    // Don't drag if clicking buttons
                    if (e.target.classList.contains('window-button')) return;
                    
                    const state = this.windowStates.get(id);
                    if (state && state.state === 'normal') {
                        this.startDragging(windowEl, e, id);
                    } else if (state && (state.state === 'maximized' || state.state.startsWith('snapped'))) {
                        // Unsnap/unmaximize on drag
                        this.restoreFromSnap(id, e);
                    }
                });

                // Double-click title bar to maximize
                titleBar.addEventListener('dblclick', (e) => {
                    if (!e.target.classList.contains('window-button')) {
                        this.toggleMaximize(id);
                    }
                });

                // Setup resize handles
                const resizeHandles = windowEl.querySelectorAll('.resize-handle');
                resizeHandles.forEach(handle => {
                    handle.addEventListener('mousedown', (e) => {
                        e.stopPropagation();
                        const direction = handle.className.split(' ')[1].replace('resize-', '');
                        this.startResizing(windowEl, e, direction, id);
                    });
                });
            }

            startDragging(windowEl, e, windowId) {
                this.dragState.isDragging = true;
                this.dragState.currentWindow = windowEl;
                this.dragState.currentWindowId = windowId;
                this.dragState.startX = e.clientX;
                this.dragState.startY = e.clientY;
                
                // Get current window position
                const rect = windowEl.getBoundingClientRect();
                this.dragState.windowX = rect.left;
                this.dragState.windowY = rect.top - 28; // Subtract menu bar height
                
                // Change cursor
                document.body.style.cursor = 'grabbing';
                windowEl.style.cursor = 'grabbing';
                
                // Prevent text selection while dragging
                e.preventDefault();
            }

            handleDragging(e) {
                if (!this.dragState.isDragging) return;
                
                const deltaX = e.clientX - this.dragState.startX;
                const deltaY = e.clientY - this.dragState.startY;
                
                const newX = this.dragState.windowX + deltaX;
                const newY = this.dragState.windowY + deltaY;
                
                // Update window position
                this.dragState.currentWindow.style.left = `${newX}px`;
                this.dragState.currentWindow.style.top = `${newY}px`;
                
                // Check for snap zones
                this.checkSnapZones(e.clientX, e.clientY);
            }

            checkSnapZones(mouseX, mouseY) {
                const snapThreshold = 20; // pixels from edge
                const windowWidth = window.innerWidth;
                const menuBarHeight = 28;
                
                let newSnapZone = null;
                
                // Left edge
                if (mouseX <= snapThreshold) {
                    newSnapZone = 'left';
                }
                // Right edge
                else if (mouseX >= windowWidth - snapThreshold) {
                    newSnapZone = 'right';
                }
                // Top edge (fullscreen)
                else if (mouseY <= menuBarHeight + snapThreshold) {
                    newSnapZone = 'top';
                }
                
                // Update snap preview if zone changed
                if (newSnapZone !== this.snapZone) {
                    this.snapZone = newSnapZone;
                    this.updateSnapPreview(newSnapZone);
                }
            }

            updateSnapPreview(zone) {
                if (!zone) {
                    this.snapPreview.classList.remove('show');
                    return;
                }
                
                const menuBarHeight = 28;
                const dockHeight = 70;
                const availableHeight = window.innerHeight - menuBarHeight - dockHeight;
                
                this.snapPreview.classList.add('show');
                
                if (zone === 'left') {
                    this.snapPreview.style.left = '0';
                    this.snapPreview.style.top = `${menuBarHeight}px`;
                    this.snapPreview.style.width = '50%';
                    this.snapPreview.style.height = `${availableHeight}px`;
                } else if (zone === 'right') {
                    this.snapPreview.style.left = '50%';
                    this.snapPreview.style.top = `${menuBarHeight}px`;
                    this.snapPreview.style.width = '50%';
                    this.snapPreview.style.height = `${availableHeight}px`;
                } else if (zone === 'top') {
                    this.snapPreview.style.left = '0';
                    this.snapPreview.style.top = `${menuBarHeight}px`;
                    this.snapPreview.style.width = '100%';
                    this.snapPreview.style.height = `${availableHeight}px`;
                }
            }

            stopDragging() {
                if (!this.dragState.isDragging) return;
                
                // Apply snap if in snap zone
                if (this.snapZone && this.dragState.currentWindowId) {
                    this.snapWindow(this.dragState.currentWindowId, this.snapZone);
                }
                
                this.dragState.isDragging = false;
                this.dragState.currentWindow = null;
                this.dragState.currentWindowId = null;
                
                // Hide snap preview
                this.snapZone = null;
                this.updateSnapPreview(null);
                
                // Reset cursor
                document.body.style.cursor = '';
                
                const windows = document.querySelectorAll('.window');
                windows.forEach(win => win.style.cursor = '');
            }

            snapWindow(id, position) {
                const windowEl = this.windows.get(id);
                const state = this.windowStates.get(id);
                
                if (!windowEl || !state) return;
                
                const menuBarHeight = 28;
                const dockHeight = 70;
                const availableHeight = window.innerHeight - menuBarHeight - dockHeight;
                
                // Save current position before snapping
                if (state.state === 'normal') {
                    const rect = windowEl.getBoundingClientRect();
                    state.normalPosition = {
                        left: rect.left,
                        top: rect.top - menuBarHeight,
                        width: rect.width,
                        height: rect.height
                    };
                }
                
                // Apply snap position with animation
                windowEl.style.transition = 'all 0.3s ease';
                
                if (position === 'left') {
                    windowEl.style.left = '0';
                    windowEl.style.top = '0';
                    windowEl.style.width = '50%';
                    windowEl.style.height = `${availableHeight}px`;
                    state.state = 'snapped-left';
                } else if (position === 'right') {
                    windowEl.style.left = '50%';
                    windowEl.style.top = '0';
                    windowEl.style.width = '50%';
                    windowEl.style.height = `${availableHeight}px`;
                    state.state = 'snapped-right';
                } else if (position === 'top') {
                    windowEl.style.left = '0';
                    windowEl.style.top = '0';
                    windowEl.style.width = '100%';
                    windowEl.style.height = `${availableHeight}px`;
                    state.state = 'maximized';
                    windowEl.classList.add('maximized');
                }
                
                // Remove transition after animation
                setTimeout(() => {
                    windowEl.style.transition = '';
                }, 300);
            }

            minimizeWindow(id) {
                const windowEl = this.windows.get(id);
                const state = this.windowStates.get(id);
                
                if (!windowEl || !state) return;
                
                // Save current state
                state.state = 'minimized';
                
                // Animate out
                windowEl.style.transition = 'all 0.3s ease';
                windowEl.style.transform = 'scale(0.3)';
                windowEl.style.opacity = '0';
                
                setTimeout(() => {
                    windowEl.style.display = 'none';
                    windowEl.style.transition = '';
                    windowEl.style.transform = '';
                    windowEl.style.opacity = '';
                }, 300);
                
                // Add to dock (visual indicator)
                this.addMinimizedIndicator(id);
            }

            restoreWindow(id) {
                const windowEl = this.windows.get(id);
                const state = this.windowStates.get(id);
                
                if (!windowEl || !state) return;
                
                state.state = 'normal';
                windowEl.style.display = 'flex';
                
                // Animate in
                windowEl.style.transition = 'all 0.3s ease';
                windowEl.style.transform = 'scale(0.9)';
                windowEl.style.opacity = '0';
                
                setTimeout(() => {
                    windowEl.style.transform = 'scale(1)';
                    windowEl.style.opacity = '1';
                }, 10);
                
                setTimeout(() => {
                    windowEl.style.transition = '';
                    windowEl.style.transform = '';
                }, 300);
                
                this.focusWindow(id);
                this.removeMinimizedIndicator(id);
            }

            toggleMaximize(id) {
                const windowEl = this.windows.get(id);
                const state = this.windowStates.get(id);
                
                if (!windowEl || !state) return;
                
                if (state.state === 'maximized') {
                    // Restore to normal
                    state.state = 'normal';
                    const normal = state.normalPosition;
                    windowEl.style.left = `calc(50% - 300px + ${normal.left}px)`;
                    windowEl.style.top = `calc(50% - 200px + ${normal.top}px)`;
                    windowEl.style.width = `${normal.width}px`;
                    windowEl.style.height = `${normal.height}px`;
                    windowEl.classList.remove('maximized');
                } else {
                    // Save current position/size
                    const rect = windowEl.getBoundingClientRect();
                    state.normalPosition = {
                        left: rect.left,
                        top: rect.top - 28,
                        width: rect.width,
                        height: rect.height
                    };
                    
                    // Maximize
                    state.state = 'maximized';
                    windowEl.style.left = '0';
                    windowEl.style.top = '0';
                    windowEl.style.width = '100%';
                    windowEl.style.height = 'calc(100vh - 98px)'; // Full height minus menu and dock
                    windowEl.classList.add('maximized');
                }
            }

            startResizing(windowEl, e, direction, id) {
                const state = this.windowStates.get(id);
                if (state && state.state === 'maximized') return; // Can't resize maximized windows
                
                this.resizeState.isResizing = true;
                this.resizeState.currentWindow = windowEl;
                this.resizeState.direction = direction;
                this.resizeState.startX = e.clientX;
                this.resizeState.startY = e.clientY;
                
                const rect = windowEl.getBoundingClientRect();
                this.resizeState.startWidth = rect.width;
                this.resizeState.startHeight = rect.height;
                this.resizeState.startLeft = rect.left;
                this.resizeState.startTop = rect.top - 28;
                
                e.preventDefault();
            }

            handleResizing(e) {
                if (!this.resizeState.isResizing) return;
                
                const deltaX = e.clientX - this.resizeState.startX;
                const deltaY = e.clientY - this.resizeState.startY;
                const dir = this.resizeState.direction;
                const win = this.resizeState.currentWindow;
                
                let newWidth = this.resizeState.startWidth;
                let newHeight = this.resizeState.startHeight;
                let newLeft = this.resizeState.startLeft;
                let newTop = this.resizeState.startTop;
                
                // Handle horizontal resizing
                if (dir.includes('e')) {
                    newWidth = Math.max(400, this.resizeState.startWidth + deltaX);
                }
                if (dir.includes('w')) {
                    newWidth = Math.max(400, this.resizeState.startWidth - deltaX);
                    newLeft = this.resizeState.startLeft + deltaX;
                }
                
                // Handle vertical resizing
                if (dir.includes('s')) {
                    newHeight = Math.max(300, this.resizeState.startHeight + deltaY);
                }
                if (dir.includes('n')) {
                    newHeight = Math.max(300, this.resizeState.startHeight - deltaY);
                    newTop = this.resizeState.startTop + deltaY;
                }
                
                win.style.width = `${newWidth}px`;
                win.style.height = `${newHeight}px`;
                win.style.left = `${newLeft}px`;
                win.style.top = `${newTop}px`;
            }

            stopResizing() {
                if (!this.resizeState.isResizing) return;
                
                this.resizeState.isResizing = false;
                this.resizeState.currentWindow = null;
                this.resizeState.direction = null;
            }

            addMinimizedIndicator(id) {
                // Add visual indicator to dock with icon
                const windowEl = this.windows.get(id);
                const title = windowEl.querySelector('.window-title').textContent;
                
                // Get icon from desktop icon if available
                let icon = 'üìÑ'; // default
                const desktopIcon = document.querySelector(`[data-window="${id}"]`);
                if (desktopIcon) {
                    const iconEl = desktopIcon.querySelector('.icon-image');
                    if (iconEl) {
                        icon = iconEl.textContent;
                    }
                }
                
                const indicator = document.createElement('div');
                indicator.className = 'minimized-indicator';
                indicator.dataset.windowId = id;
                indicator.innerHTML = `<div class="minimized-icon">${icon}</div>`;
                indicator.title = `Restore ${title}`;
                indicator.addEventListener('click', () => this.restoreWindow(id));
                
                document.querySelector('.dock').appendChild(indicator);
            }

            removeMinimizedIndicator(id) {
                const indicator = document.querySelector(`.minimized-indicator[data-window-id="${id}"]`);
                if (indicator) indicator.remove();
            }

            restoreFromSnap(id, e) {
                const windowEl = this.windows.get(id);
                const state = this.windowStates.get(id);
                
                if (!windowEl || !state) return;
                
                // Restore to normal size
                const normal = state.normalPosition;
                
                // Position under cursor (centered on title bar)
                const offsetX = e.clientX - normal.width / 2;
                const offsetY = e.clientY - 28;
                
                windowEl.style.left = `${offsetX}px`;
                windowEl.style.top = `${offsetY}px`;
                windowEl.style.width = `${normal.width}px`;
                windowEl.style.height = `${normal.height}px`;
                windowEl.classList.remove('maximized');
                
                state.state = 'normal';
                
                // Start dragging from here
                this.startDragging(windowEl, e, id);
            }

            async loadContent(windowEl, url) {
                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error('Failed to fetch');
                    }
                    const html = await response.text();
                    
                    // Parse HTML and extract content
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    
                    // Get the main container content and remove nav
                    const container = doc.querySelector('.container');
                    if (container) {
                        // Clone to avoid modifying original
                        const content = container.cloneNode(true);
                        // Remove any nav elements that might be inside
                        const navs = content.querySelectorAll('nav, .nav');
                        navs.forEach(nav => nav.remove());
                        windowEl.querySelector('.window-content').innerHTML = content.innerHTML;
                    } else {
                        // Fallback: get body but remove nav and scripts
                        const bodyClone = doc.body.cloneNode(true);
                        const navs = bodyClone.querySelectorAll('nav, .nav');
                        navs.forEach(nav => nav.remove());
                        const scripts = bodyClone.querySelectorAll('script');
                        scripts.forEach(script => script.remove());
                        windowEl.querySelector('.window-content').innerHTML = bodyClone.innerHTML;
                    }
                } catch (error) {
                    console.error('Error loading content:', error);
                    windowEl.querySelector('.window-content').innerHTML = 
                        '<p style="color: #888; text-align: center; margin-top: 40px;">Error loading content. Please try again.</p>';
                }
            }

            focusWindow(id) {
                // Remove active class from all windows
                this.windows.forEach(win => win.classList.remove('active'));
                
                // Add active class and bring to front
                const windowEl = this.windows.get(id);
                if (windowEl) {
                    windowEl.classList.add('active');
                    windowEl.style.zIndex = ++this.zIndexCounter;
                }
            }

            closeWindow(id) {
                const windowEl = this.windows.get(id);
                if (windowEl) {
                    windowEl.remove();
                    this.windows.delete(id);
                    this.windowStates.delete(id);
                    this.removeMinimizedIndicator(id);
                }
            }
        }

        // Initialize window manager
        const windowManager = new WindowManager();

        // Global mouse event listeners for dragging and resizing
        document.addEventListener('mousemove', (e) => {
            windowManager.handleDragging(e);
            windowManager.handleResizing(e);
        });

        document.addEventListener('mouseup', () => {
            windowManager.stopDragging();
            windowManager.stopResizing();
        });

        // Page content data (since fetch doesn't work with file:// protocol)
        const pageContent = {
            home: `
                <div class="about-layout">
                    <div class="about-content">
                        <p class="intro-text">
                            i'm ali taha.<br>
                            i study computer engineering @ uwaterloo.<br>
                            i work on performance engineering.<br>
                        </p>
                        <p class="contact-text">
                            you can reach me at <a href="mailto:ali.taha@uwaterloo.ca">ali.taha@uwaterloo.ca</a>
                        </p>
                    </div>
                </div>
            `,
            technical: `
                <h1>technical</h1>
                <h2>articles</h2>
                <div class="writing-item">
                    <p class="date">september 19, 2025</p>
                    <h3><a href="https://www.modular.com/blog/matrix-multiplication-on-blackwell-part-4---breaking-sota" target="_blank">part 4: breaking sota: achieving 103% of peak performance on blackwell</a></h3>
                    <p class="description">the final optimization techniques that push our matmul kernel past nvidia's cublas, reaching 103% of theoretical peak performance on blackwell gpus.</p>
                </div>
                <div class="writing-item">
                    <p class="date">september 12, 2025</p>
                    <h3><a href="https://www.modular.com/blog/matrix-multiplication-on-nvidias-blackwell-part-3-the-optimizations-behind-85-of-sota-performance" target="_blank">part 3: the optimizations behind 85% of sota performance</a></h3>
                    <p class="description">diving into advanced optimization techniques including register allocation, memory coalescing, and pipelining strategies to reach 85% of peak performance.</p>
                </div>
                <div class="writing-item">
                    <p class="date">september 5, 2025</p>
                    <h3><a href="https://www.modular.com/blog/matrix-multiplication-on-nvidias-blackwell-part-2-using-hardware-features-to-optimize-matmul" target="_blank">part 2: using blackwell hardware features to optimize matmul</a></h3>
                    <p class="description">exploring blackwell-specific features like tcgen05 instructions and tensor memory to build faster matrix multiplication kernels.</p>
                </div>
                <div class="writing-item">
                    <p class="date">august 28, 2025</p>
                    <h3><a href="https://www.modular.com/blog/matrix-multiplication-on-nvidias-blackwell-part-1-introduction" target="_blank">part 1: matrix multiplication on blackwell: introduction</a></h3>
                    <p class="description">introducing the fundamentals of gpu programming and building a simple matmul kernel in mojo. the starting point of our journey to beat cublas.</p>
                </div>
            `,
            philosophy: `
                <h1>philosophy</h1>
                <div class="writing-item">
                    <p class="date">10th October</p>
                    <h3><a href="blogs/elements-a-reflection.html">elements- a reflection</a></h3>
                    <p class="description">finding God</p>
                </div>
                <div class="writing-item">
                    <p class="date">incomplete</p>
                    <h3><a href="blogs/how-to-find-your-purpose.html">how to find your purpose</a></h3>
                    <p class="description">i did not find mine yet. i'll update this when i do</p>
                </div>
            `,
            experience: `
                <h1>experience</h1>
                <div class="experience-item">
                    <div class="exp-header">
                        <h3>performance engineering intern</h3>
                        <span class="company">modular</span>
                    </div>
                    <p class="meta">may ‚Äì august 2025 ‚Ä¢ los altos, ca</p>
                    <ul>
                        <li>built matmul kernels on blackwell that beat nvidia's cublas at 103% sota (<a href="https://www.modular.com/blog/matrix-multiplication-on-nvidias-blackwell-part-1-introduction" target="_blank">blog</a>, <a href="https://github.com/modular/modular/tree/main/max/kernels/test/gpu/linalg/matmul_blackwell_iterative" target="_blank">code</a>)</li>
                        <li>wrote 1d conv kernel that beat cudnn by 7x, speeding up inworld ai's tts model by 12%</li>
                        <li>implemented hilbert curve scheduling for h100</li>
                        <li>built specialized kernels (3d conv, bicubic resize) for midjourney inference</li>
                    </ul>
                </div>
                <div class="experience-item">
                    <div class="exp-header">
                        <h3>software engineering intern</h3>
                        <span class="company">tesla</span>
                    </div>
                    <p class="meta">sep ‚Äì dec 2024 ‚Ä¢ fremont, ca</p>
                    <ul>
                        <li>built computer vision prototype for 2-post lift safety in service centers</li>
                        <li>trained segmentation model to detect lift arms and compute safe angle thresholds</li>
                    </ul>
                </div>
                <div class="experience-item">
                    <div class="exp-header">
                        <h3>software engineering intern</h3>
                        <span class="company">ford</span>
                    </div>
                    <p class="meta">jan ‚Äì april 2024 ‚Ä¢ dearborn, mi</p>
                    <ul>
                        <li>built automated test suite using playwright and typescript</li>
                    </ul>
                </div>
                <div class="experience-item">
                    <div class="exp-header">
                        <h3>software engineering intern</h3>
                        <span class="company">blackberry</span>
                    </div>
                    <p class="meta">may ‚Äì aug 2023 ‚Ä¢ waterloo, on</p>
                    <ul>
                        <li>built full-stack analytics dashboard for service data</li>
                    </ul>
                </div>
                <h2 style="margin-top: 50px;">projects</h2>
                <div class="experience-item">
                    <div class="exp-header">
                        <h3>matmul rewritten: cuda kernel study</h3>
                    </div>
                    <p class="meta">cuda ‚Ä¢ <a href="https://github.com/AliesTaha" target="_blank">github</a></p>
                    <ul>
                        <li>built cuda matmul kernel for a100 from scratch, progressively optimizing performance</li>
                        <li>implemented memory coalescing, increasing bandwidth from 15gb/s to 110gb/s (6.5√ó speedup)</li>
                        <li>added 1d block tiling to improve register reuse, achieving 8.5 tflops</li>
                    </ul>
                </div>
                <div class="experience-item">
                    <div class="exp-header">
                        <h3>bare metal neural network</h3>
                    </div>
                    <p class="meta">python, numpy ‚Ä¢ <a href="https://github.com/AliesTaha/BareNeuralNetwork" target="_blank">github</a></p>
                    <ul>
                        <li>built neural network from scratch using only numpy</li>
                        <li>implemented dense layers, activation, and loss functions</li>
                        <li>built custom optimizers (sgd, adam) and mini-batch gradient descent</li>
                    </ul>
                </div>
            `,
            contact: `
                <h1>get in touch</h1>
                <p>feel free to reach out for opportunities, collaborations, or just to chat about gpus and performance optimization.</p>
                <div class="contact-links">
                    <div class="contact-item">
                        <span class="label">email</span>
                        <a href="mailto:ali.taha@uwaterloo.ca">ali.taha@uwaterloo.ca</a>
                    </div>
                    <div class="contact-item">
                        <span class="label">github</span>
                        <a href="https://github.com/aliestaha" target="_blank">github.com/aliestaha</a>
                    </div>
                    <div class="contact-item">
                        <span class="label">linkedin</span>
                        <a href="https://www.linkedin.com/in/aliestaha/" target="_blank">linkedin.com/in/aliestaha</a>
                    </div>
                </div>
            `
        };

        // Update clock
        function updateClock() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            const displayHours = hours % 12 || 12;
            document.getElementById('clock').textContent = `${displayHours}:${minutes} ${ampm}`;
        }
        updateClock();
        setInterval(updateClock, 60000);

        // Desktop icon interactions
        document.querySelectorAll('.desktop-icon').forEach(icon => {
            let clickCount = 0;
            let clickTimer = null;
            let dragStarted = false;

            icon.addEventListener('mousedown', (e) => {
                if (e.button !== 0) return; // Only left click
                
                // Clear any existing drag timer
                if (icon.dataset.dragTimer) {
                    clearTimeout(parseInt(icon.dataset.dragTimer));
                }
                
                dragStarted = false;
                clickCount++;
                
                if (clickCount === 1) {
                    // Single click - select
                    document.querySelectorAll('.desktop-icon').forEach(i => i.classList.remove('selected'));
                    icon.classList.add('selected');
                    
                    // Prepare for potential drag
                    const startDragTimer = setTimeout(() => {
                        if (!dragStarted && e.buttons === 1) {
                            dragStarted = true;
                            startIconDrag(icon, e);
                        }
                    }, 150); // Small delay before drag starts
                    
                    icon.dataset.dragTimer = startDragTimer.toString();
                    
                    clickTimer = setTimeout(() => {
                        clickCount = 0;
                    }, 300);
                }
            });
            
            // Clear drag timer on mouseup
            icon.addEventListener('mouseup', () => {
                if (icon.dataset.dragTimer) {
                    clearTimeout(parseInt(icon.dataset.dragTimer));
                    icon.dataset.dragTimer = null;
                }
            });

            icon.addEventListener('dblclick', (e) => {
                    clearTimeout(clickTimer);
                    clickCount = 0;
                    e.preventDefault();
                
                // Remove selection on double-click
                icon.classList.remove('selected');
                    
                    const windowId = icon.dataset.window;
                    const url = icon.dataset.url;
                    const label = icon.querySelector('.icon-label').textContent;
                    
                    if (windowId && pageContent[windowId]) {
                        // Open window with embedded content
                        windowManager.createWindow(windowId, label, pageContent[windowId]);
                    } else if (windowId === 'readme') {
                        // Special case for README
                        windowManager.createWindow('readme', 'README.md', `
                            <h1>ali taha</h1>
                            <p>Personal website built with desktop OS interface.</p>
                            <h2>About</h2>
                            <p>Computer Engineering student @ UWaterloo</p>
                            <p>Performance Engineering enthusiast</p>
                            <h2>Tech Stack</h2>
                            <ul>
                                <li>HTML, CSS, JavaScript</li>
                                <li>Desktop OS-inspired interface</li>
                                <li>Window management system</li>
                            </ul>
                        `);
                    } else {
                        // Other icons
                        showNotification(`Opening ${label}...`);
                    }
            });
        });

        // Icon dragging functions
        function startIconDrag(icon, e) {
            windowManager.iconDragState.isDragging = true;
            windowManager.iconDragState.currentIcon = icon;
            windowManager.iconDragState.startX = e.clientX;
            windowManager.iconDragState.startY = e.clientY;
            
            const rect = icon.getBoundingClientRect();
            windowManager.iconDragState.iconX = rect.left;
            windowManager.iconDragState.iconY = rect.top;
            
            icon.style.position = 'fixed';
            icon.style.left = `${rect.left}px`;
            icon.style.top = `${rect.top}px`;
            icon.style.zIndex = '10000';
            icon.classList.add('dragging-icon');
            
            e.preventDefault();
        }

        function handleIconDrag(e) {
            if (!windowManager.iconDragState.isDragging) return;
            
            const deltaX = e.clientX - windowManager.iconDragState.startX;
            const deltaY = e.clientY - windowManager.iconDragState.startY;
            
            const newX = windowManager.iconDragState.iconX + deltaX;
            const newY = windowManager.iconDragState.iconY + deltaY;
            
            windowManager.iconDragState.currentIcon.style.left = `${newX}px`;
            windowManager.iconDragState.currentIcon.style.top = `${newY}px`;
        }

        function stopIconDrag() {
            if (!windowManager.iconDragState.isDragging) return;
            
            const icon = windowManager.iconDragState.currentIcon;
            if (icon) {
                icon.classList.remove('dragging-icon');
                icon.classList.remove('selected'); // Remove the gray highlight after dragging
                // Keep the fixed position and coordinates from drag
                // Don't reset - let user reposition icons
            }
            
            windowManager.iconDragState.isDragging = false;
            windowManager.iconDragState.currentIcon = null;
        }

        // Add icon drag listeners to document  
        document.addEventListener('mousemove', (e) => {
            handleIconDrag(e);
        });

        document.addEventListener('mouseup', (e) => {
            // Clear all drag timers
            document.querySelectorAll('.desktop-icon').forEach(icon => {
                if (icon.dataset.dragTimer) {
                    clearTimeout(parseInt(icon.dataset.dragTimer));
                    icon.dataset.dragTimer = null;
                }
            });
            stopIconDrag();
        });

        // Dock interactions
        document.querySelectorAll('.dock-item').forEach(item => {
            item.addEventListener('click', () => {
                const windowId = item.dataset.window;
                if (windowId && pageContent[windowId]) {
                    const title = item.getAttribute('title');
                    windowManager.createWindow(windowId, title, pageContent[windowId]);
                }
            });
        });

        // Trash in dock
        document.querySelector('.trash-dock-icon').addEventListener('click', (e) => {
            e.preventDefault();
            windowManager.createWindow('trash', 'üóëÔ∏è Trash', `
                <h1>Trash</h1>
                <p style="color: #666; margin-bottom: 30px;">3 items</p>
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <div class="trash-file" onclick="window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank')" style="cursor: pointer; padding: 15px; background: rgba(0,0,0,0.02); border-radius: 8px; display: flex; align-items: center; gap: 12px; transition: background 0.2s;">
                        <span style="font-size: 32px;">üìÑ</span>
                        <div>
                            <div style="font-weight: 500;">TOP_SECRET.txt</div>
                            <div style="font-size: 14px; color: #888;">Very classified stuff</div>
                        </div>
                    </div>
                    <div class="trash-file" onclick="window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank')" style="cursor: pointer; padding: 15px; background: rgba(0,0,0,0.02); border-radius: 8px; display: flex; align-items: center; gap: 12px; transition: background 0.2s;">
                        <span style="font-size: 32px;">üìã</span>
                        <div>
                            <div style="font-weight: 500;">NDA.txt</div>
                            <div style="font-size: 14px; color: #888;">Don't look at this</div>
                        </div>
                    </div>
                    <div class="trash-file" onclick="window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank')" style="cursor: pointer; padding: 15px; background: rgba(0,0,0,0.02); border-radius: 8px; display: flex; align-items: center; gap: 12px; transition: background 0.2s;">
                        <span style="font-size: 32px;">üé¨</span>
                        <div>
                            <div style="font-weight: 500;">spicy.mov</div>
                            <div style="font-size: 14px; color: #888;">üå∂Ô∏è Handle with care</div>
                        </div>
                    </div>
                </div>
                <style>
                    .trash-file:hover {
                        background: rgba(0,0,0,0.06) !important;
                    }
                </style>
            `);
        });

        // Simple notification system
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        // Roadmap - Career journey
        document.querySelector('.roadmap-icon').addEventListener('dblclick', (e) => {
            e.preventDefault();
            windowManager.createWindow('roadmap', 'Roadmap', `
                <div style="padding: 20px;">
                    <svg width="100%" height="340" viewBox="0 0 700 340" style="transform: scale(1.2); transform-origin: center center;">
                        <!-- Path line -->
                        <path d="M 80 280 L 160 220 L 240 160 L 320 100 L 420 80 L 520 80 L 620 80" 
                              stroke="#1a1a1a" 
                              stroke-width="2" 
                              stroke-dasharray="5,5" 
                              fill="none" 
                              opacity="0.3"/>
                        
                        <!-- BlackBerry -->
                        <circle cx="80" cy="280" r="20" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
                        <text x="80" y="310" text-anchor="middle" font-weight="500" font-size="13" fill="#1a1a1a">BlackBerry</text>
                        <text x="80" y="325" text-anchor="middle" font-size="11" fill="#888">2023</text>
                        
                        <!-- Ford -->
                        <circle cx="160" cy="220" r="20" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
                        <text x="160" y="250" text-anchor="middle" font-weight="500" font-size="13" fill="#1a1a1a">Ford</text>
                        <text x="160" y="265" text-anchor="middle" font-size="11" fill="#888">2024</text>
                        
                        <!-- Tesla -->
                        <circle cx="240" cy="160" r="20" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
                        <text x="240" y="190" text-anchor="middle" font-weight="500" font-size="13" fill="#1a1a1a">Tesla</text>
                        <text x="240" y="205" text-anchor="middle" font-size="11" fill="#888">2024</text>
                        
                        <!-- Modular -->
                        <circle cx="320" cy="100" r="20" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
                        <text x="320" y="130" text-anchor="middle" font-weight="500" font-size="13" fill="#1a1a1a">Modular</text>
                        <text x="320" y="145" text-anchor="middle" font-size="11" fill="#888">2025</text>
                        
                        <!-- Mystery 1 -->
                        <circle cx="420" cy="80" r="20" fill="#e0e0e0" stroke="#999" stroke-width="2"/>
                        <text x="420" y="87" text-anchor="middle" fill="#666" font-weight="bold" font-size="18">?</text>
                        <text x="420" y="110" text-anchor="middle" font-weight="500" font-size="13" fill="#888">???</text>
                        
                        <!-- Mystery 2 -->
                        <circle cx="520" cy="80" r="20" fill="#e0e0e0" stroke="#999" stroke-width="2"/>
                        <text x="520" y="87" text-anchor="middle" fill="#666" font-weight="bold" font-size="18">?</text>
                        <text x="520" y="110" text-anchor="middle" font-weight="500" font-size="13" fill="#888">???</text>
                        
                        <!-- World Domination -->
                        <g transform="translate(620, 80)">
                            <line x1="-12" y1="-12" x2="12" y2="12" stroke="#D32F2F" stroke-width="4" stroke-linecap="round"/>
                            <line x1="12" y1="-12" x2="-12" y2="12" stroke="#D32F2F" stroke-width="4" stroke-linecap="round"/>
                            <circle cx="0" cy="0" r="18" fill="none" stroke="#D32F2F" stroke-width="2"/>
                        </g>
                        <text x="620" y="110" text-anchor="middle" font-weight="600" font-size="13" fill="#D32F2F">World Domination</text>
                    </svg>
                </div>
            `);
        });

        // Trash can easter egg with secret files
        document.querySelector('.trash-icon').addEventListener('dblclick', (e) => {
            e.preventDefault();
            windowManager.createWindow('trash', 'üóëÔ∏è Trash', `
                <h1>Trash</h1>
                <p style="color: #666; margin-bottom: 30px;">3 items</p>
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <div class="trash-file" onclick="window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank')" style="cursor: pointer; padding: 15px; background: rgba(0,0,0,0.02); border-radius: 8px; display: flex; align-items: center; gap: 12px; transition: background 0.2s;">
                        <span style="font-size: 32px;">üìÑ</span>
                        <div>
                            <div style="font-weight: 500;">TOP_SECRET.txt</div>
                            <div style="font-size: 14px; color: #888;">Very classified stuff</div>
                        </div>
                    </div>
                    <div class="trash-file" onclick="window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank')" style="cursor: pointer; padding: 15px; background: rgba(0,0,0,0.02); border-radius: 8px; display: flex; align-items: center; gap: 12px; transition: background 0.2s;">
                        <span style="font-size: 32px;">üìã</span>
                        <div>
                            <div style="font-weight: 500;">NDA.txt</div>
                            <div style="font-size: 14px; color: #888;">Don't look at this</div>
                        </div>
                    </div>
                    <div class="trash-file" onclick="window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank')" style="cursor: pointer; padding: 15px; background: rgba(0,0,0,0.02); border-radius: 8px; display: flex; align-items: center; gap: 12px; transition: background 0.2s;">
                        <span style="font-size: 32px;">üé¨</span>
                        <div>
                            <div style="font-weight: 500;">spicy.mov</div>
                            <div style="font-size: 14px; color: #888;">üå∂Ô∏è Handle with care</div>
                        </div>
                    </div>
                </div>
                <style>
                    .trash-file:hover {
                        background: rgba(0,0,0,0.06) !important;
                    }
                </style>
            `);
        });
    </script>
</body>
</html>

